<!DOCTYPE html>

<html lang="pt-BR">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="author" content="Vinicius Baggio Fuentes" />

        <title>Filtros &mdash; vinibaggio.com - refactoring myself each day</title>

        <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
        <link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
        <!--[if IE]>
          <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
        <![endif]-->
    </head>

    <body>
      <header>
        <h1><a href="/">vinibaggio.com</a></h1>
        <h2>refactoring myself each day.</h2>
        <a href="http://www.github.com/vinibaggio" id="octocat" class="image-icon" title="Meu perfil no GitHub">GitHub</a>
        <a href="http://www.twitter.com/vinibaggio" id="twitter" class="image-icon" title="Meu Twitter">Twitter</a>
      </header>
      <article>
        <h1>Filtros</h1>

<p>No Vim, é possível filtrar o conteúdo de um buffer em um comando do shell.
Sabemos que as aplicações *nix são do tipo "faça uma coisa e faça-a bem".
Então, temos várias coisas úteis, como <kbd>uniq</kbd>, <kbd>grep</kbd>,
<kbd>cut</kbd>, <kbd>awk</kbd>, <kbd>egrep</kbd> e etc. Dessa
forma, podemos combinar os dois e fazer algumas coisas interessantes.</p>

<p>O primeiro exemplo é de como podemos pegar o conteúdo em um buffer do Vim e
obter apenas as entradas únicas:</p>

<p>Conteúdo:</p>

<pre><code>a@a.com
a@a.com
b@b.com
c@c.com
</code></pre>

<p>Assim, com esse conteúdo, podemos executar: <kbd>:%!uniq</kbd>. O resultado é:</p>

<pre><code>a@a.com
b@b.com
c@c.com
</code></pre>

<p>O comando é simples. Com o conteúdo de todo o buffer, passe para o comando do
shell (identificado por !, pois podemos executar coisas como
<kbd>:!mkdir /bla</kbd>) e coloque o resultado no próprio buffer.</p>

<p>Eu tive que fazer algo parecido com isso ontem. Eu tinha um arquivo com várias
entradas (cerca de 9000) e precisava de apenas entradas cujos emails não estavam
contidos em outra lista. Dessa forma, o que eu fiz foi o seguinte:</p>

<p>entradas:</p>

<pre><code>Entrada1: a@a.com, x, y, z, theta
Entrada2: b@b.com, x, y, z, theta
Entrada3: c@c.com, x, y, z, theta
</code></pre>

<p>blacklist:</p>

<pre><code>b@b.com
</code></pre>

<p>Assim, com o buffer "entradas" aberto, para filtrar o conteúdo, bastou executar
<kbd>:%!fgrep -vf blacklist</kbd>. O grep apenas exibe comandos que dão <em>match</em>, enquanto
o parâmetro <kbd>-v</kbd> faz a inversão disso, ou seja, eu quero as entradas que <em>não</em>
ocorra match. O <kbd>-f</kbd> é para obter os matches de um arquivo. Dessa forma o resultado
fica:</p>

<pre><code>Entrada1: a@a.com, x, y, z, theta
Entrada3: c@c.com, x, y, z, theta
</code></pre>

<p>Mais detalhes sobre isso em <a href="http://www.softpanorama.org/Editors/Vimorama/vim_piping.shtml">Vim piping</a>.</p>

      </article>
      <section class="read-more">
        <h1>Leia também</h1>
        <ul>
          
          <li>
            <span>27/08/2010</span> &raquo;
            <a href="/Geral/novo-blog.html">Novo Blog</a> &mdash; na(s) categoria(s):
            Geral
          </li>
          
        </ul>
      </section>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        /**
          * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread]
          */
        (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = 'http://vinibaggio.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=vinibaggio">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
      <footer>
        <ul>
          <li><a href="/" title="Página inicial">Home</a></li>
        </ul>
        vinibaggio.com - nenhum direito reservado.
      </footer>
      <script type="text/javascript">
      var disqus_shortname = 'vinibaggio';
      (function () {
        var s = document.createElement('script'); s.async = true;
        s.src = 'http://disqus.com/forums/vinibaggio/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
      </script>
      <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-6968963-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

      </script>

    </body>
</html>

